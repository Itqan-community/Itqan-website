---
import { defaultLang } from '../i18n/ui';
import BaseLayout from '../layouts/BaseLayout.astro';
import { useTranslations } from '../i18n/utils';

export function getStaticPaths() {
  return [
    { params: { path: undefined } }
  ];
}

const currentPath = Astro.url.pathname;

// If the path doesn't end with a slash, redirect to the version with a slash
if (!currentPath.endsWith('/')) {
  Astro.redirect(`${currentPath}/`);
}

// Check if the path starts with a language code
const langMatch = currentPath.match(/^\/([a-z]{2})\//);
const lang = langMatch ? (langMatch[1] as 'ar' | 'en') : defaultLang;
if (!['ar', 'en'].includes(lang)) {
  Astro.redirect(`/${defaultLang}${currentPath}`);
}

// If we get here, the path is valid but doesn't match any static routes
const t = useTranslations(lang);
---
<BaseLayout
  title="404 - Page Not Found"
  description={t('home.hero.subtitle1')}
  lang={lang}
  path={currentPath}
>
  <div class="not-found">
    <h1>404</h1>
    <p>{t('home.hero.subtitle1')}</p>
    <a href={`/${lang}/`} class="back-home">
      {t('nav.home')}
    </a>
  </div>
</BaseLayout>

<style>
  .not-found {
    text-align: center;
    padding: 4rem 1rem;
  }

  h1 {
    font-size: 6rem;
    margin-bottom: 1rem;
    color: var(--color-primary);
  }

  p {
    font-size: 1.5rem;
    margin-bottom: 2rem;
    color: var(--color-text);
  }

  .back-home {
    display: inline-block;
    padding: 1rem 2rem;
    background-color: var(--color-primary);
    color: white;
    text-decoration: none;
    border-radius: 4px;
    transition: background-color 0.2s ease;
  }

  .back-home:hover {
    background-color: var(--color-primary-dark);
  }
</style> 